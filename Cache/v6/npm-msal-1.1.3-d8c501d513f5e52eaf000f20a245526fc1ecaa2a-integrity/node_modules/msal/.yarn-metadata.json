{
  "manifest": {
    "name": "msal",
    "author": {
      "name": "Microsoft",
      "email": "nugetaad@microsoft.com",
      "url": "https://www.microsoft.com"
    },
    "license": "MIT",
    "repository": {
      "type": "git",
      "url": "https://github.com/AzureAD/microsoft-authentication-library-for-js.git"
    },
    "version": "1.1.3",
    "description": "Microsoft Authentication Library for js",
    "keywords": [
      "implicit",
      "js",
      "AAD",
      "msal",
      "oauth"
    ],
    "main": "./lib-commonjs/index.js",
    "module": "./lib-es6/index.js",
    "types": "./lib-commonjs/index.d.ts",
    "engines": {
      "node": ">=0.8.0"
    },
    "scripts": {
      "clean": "shx rm -rf dist docs lib-commonjs lib-es6",
      "doc": "typedoc --mode modules --excludePrivate --excludeProtected --out ./docs ./src/ --gitRevision dev",
      "build:modules": "tsc && tsc -m es6 --outDir lib-es6",
      "build": "npm run clean && npm run doc && npm run build:modules && npm run lint && npm run build:webpack && npm test",
      "test": "karma start --single-run --browsers PhantomJS karma.conf.js",
      "lint": "eslint src/**/*.ts --quiet",
      "build:webpack": "webpack",
      "prepack": "npm run build"
    },
    "dependencies": {
      "tslib": "^1.9.3"
    },
    "devDependencies": {
      "@types/chai": "^4.1.7",
      "@types/handlebars": "4.0.33",
      "@types/js-base64": "^2.3.1",
      "@types/mocha": "^5.2.6",
      "@types/node": "^11.13.4",
      "@types/sinon": "^7.0.11",
      "@types/uuid": "^3.4.4",
      "@typescript-eslint/eslint-plugin": "^1.12.0",
      "@typescript-eslint/eslint-plugin-tslint": "^1.12.0",
      "@typescript-eslint/parser": "^1.12.0",
      "ajv": "6.6.1",
      "awesome-typescript-loader": "^3.2.3",
      "babel-polyfill": "^6.26.0",
      "chai": "^4.2.0",
      "eslint": "^6.0.1",
      "fork-ts-checker-webpack-plugin": "^0.5.1",
      "handlebars": "^4.1.2",
      "husky": "^1.3.1",
      "istanbul-instrumenter-loader": "^3.0.1",
      "js-yaml": "^3.13.1",
      "jsdom": "14.0.0",
      "jsdom-global": "3.0.2",
      "jshint": "^2.9.7",
      "karma": "^4.0.1",
      "karma-chai": "^0.1.0",
      "karma-chrome-launcher": "^2.2.0",
      "karma-cli": "^1.0.1",
      "karma-coverage-istanbul-reporter": "^2.0.1",
      "karma-firefox-launcher": "^0.1.7",
      "karma-mocha": "^1.3.0",
      "karma-mocha-reporter": "^2.2.5",
      "karma-phantomjs-launcher": "*",
      "karma-remap-coverage": "^0.1.5",
      "karma-remap-istanbul": "^0.6.0",
      "karma-sourcemap-loader": "^0.3.7",
      "karma-spec-reporter": "0.0.32",
      "karma-typescript": "^4.0.0",
      "karma-verbose-reporter": "0.0.6",
      "karma-webpack": "^4.0.0-rc.5",
      "mocha": "^6.1.3",
      "phantomjs-polyfill": "0.0.2",
      "shx": "^0.2.2",
      "sinon": "^7.3.1",
      "sourcemap-istanbul-instrumenter-loader": "^0.2.0",
      "ts-loader": "^5.3.1",
      "ts-node": "^8.0.3",
      "tslint": "^5.8.0",
      "typedoc": "^0.14.2",
      "typescript": "^3.2.1",
      "uglifyjs-webpack-plugin": "^2.1.1",
      "webpack": "^4.27.1",
      "webpack-cli": "^3.2.3",
      "webpack-dev-middleware": "^3.4.0"
    },
    "_registry": "npm",
    "_loc": "C:\\Users\\SriharshaShesham\\AppData\\Local\\Yarn\\Cache\\v6\\npm-msal-1.1.3-d8c501d513f5e52eaf000f20a245526fc1ecaa2a-integrity\\node_modules\\msal\\package.json",
    "readmeFilename": "README.md",
    "readme": "\nMicrosoft Authentication Library for JavaScript (MSAL.js)\n=========================================================\n\n| [Getting Started](https://docs.microsoft.com/en-us/azure/active-directory/develop/guidedsetups/active-directory-javascriptspa)| [AAD Docs](https://aka.ms/aaddevv2) | [Library Reference](https://htmlpreview.github.io/?https://raw.githubusercontent.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-core/docs/classes/_useragentapplication_.useragentapplication.html) | [Support](README.md#community-help-and-support) | [Samples](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/Samples)\n| --- | --- | --- | --- | --- |\n\n\nThe MSAL library for JavaScript enables client-side JavaScript web applications, running in a web browser, to authenticate users using [Azure AD](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-overview) work and school accounts (AAD), Microsoft personal accounts (MSA) and social identity providers like Facebook, Google, LinkedIn, Microsoft accounts, etc. through [Azure AD B2C](https://docs.microsoft.com/en-us/azure/active-directory-b2c/active-directory-b2c-overview#identity-providers) service. It also enables your app to get tokens to access [Microsoft Cloud](https://www.microsoft.com/enterprise) services such as [Microsoft Graph](https://graph.microsoft.io).\n\n[![Build Status](https://travis-ci.org/AzureAD/microsoft-authentication-library-for-js.png?branch=dev)](https://travis-ci.org/AzureAD/microsoft-authentication-library-for-js)[![npm version](https://img.shields.io/npm/v/msal.svg?style=flat)](https://www.npmjs.com/package/msal)[![npm version](https://img.shields.io/npm/dm/msal.svg)](https://nodei.co/npm/msal/)\n\n## Installation\nVia NPM:\n\n    npm install msal\n\nVia CDN:\n\n    <!-- Latest compiled and minified JavaScript -->\n    <script src=\"https://secure.aadcdn.microsoftonline-p.com/lib/<version>/js/msal.js\"></script>\n    <script src=\"https://secure.aadcdn.microsoftonline-p.com/lib/<version>/js/msal.min.js\"></script>\n\nInternet Explorer does not have native `Promise` support, and so you will need to include a polyfill for promises such as `bluebird`.\n\n    <!-- IE support: add promises polyfill before msal.js  -->\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/bluebird/3.3.4/bluebird.min.js\" class=\"pre\"></script>\n\nSee here for more details on [supported browsers and known compatability issues](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/FAQs#q4-what-browsers-is-msaljs-supported-on).\n\n## Roadmap and What To Expect From This Library\nMsal support on Javascript is a collection of libraries. `msal-core` or just simply `msal`, is the framework agnostic core library. Once our core 1.x+ is stabilized, we are going to bring our `msal-angular` library with the latest 1.x improvements.  We are planning to deprecate support for `msal-angularjs` based on usage trends of the framework and the library indicating increased adoption of Angular 2+ instead of Angular 1x. After our current libraries are up to standards, we will begin balancing new feature requests, with new platforms such as `react` and `node.js`.\n\nOur goal is to communicate extremely well with the community and to take their opinions into account. We would like to get to a monthly minor release schedule, with patches comming as often as needed.  The level of communication, planning, and granularity we want to get to will be a work in progress.\n\nPlease check our [roadmap](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki#roadmap) to see what we are working on and what we are tracking next.\n\n## OAuth 2.0 and the Implicit Flow\nMsal implments the [Implicit Grant Flow](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-implicit-grant-flow), as defined by the OAuth 2.0 protocol and is [OpenID](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-protocols-oidc) compliant.\n\nOur goal is that the library abstracts enough of the protocol away so that you can get plug and play authentication, but it is important to know and understand the implicit flow from a security perspective.\nThe implicit flow runs in the context of a web browser which cannot manage client secrets securely. It is optimized for single page apps and has one less hop between client and server so tokens are returned directly to the browser. These aspects make it naturally less secure.\nThese security concerns are mitigated per standard practices such as- use of short lived tokens (and so no refresh tokens are returned), the library requiring a registered redirect URI for the app, library matching the request and response with a unique nonce and state parameter.\n\n## Cache Storage\n\nWe offer two methods of storage for Msal, `localStorage` and `sessionStorage`.  Our recommendation is to use `sessionStorage` because it is more secure in storing tokens that are acquired by your users, but `localStorage` will give you Single Sign On accross tabs and user sessions.  We encourge you to explore the options and make the best decision for your application.\n\n### forceRefresh to skip cache\nIf you would like to skip a cached token and go to the server, please pass in the boolean `forceRefresh` into the `AuthenticationParameters` object used to make a login / token request. **WARNING:** This should not be used by default, because of the performance impact on your application.  Relying on the cache will give your users a better experience, and skipping it should only be used in scenarios where you know the current cached data does not have up to date information.  Example: Admin tool to add roles to a user that needs to get a new token with updates roles.\n\n## Usage\nThe example below walks you through how to login a user and acquire a token to be used for Microsoft's Graph Api.\n\n#### Prerequisite\n\nBefore using MSAL.js you will need to [register an application in Azure AD](https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app) to get a valid `clientId` for configuration, and to register the routes that your app will accept redirect traffic on.\n\n#### 1. Instantiate the UserAgentApplication\n\n`UserAgentApplication` can be configured with a variety of different options, detailed in our [Wiki](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL.js-1.0.0-api-release#configuration-options), but the only required parameter is `auth.clientId`.\n\nAfter instantiating your instance, if you plan on using a redirect flow (`loginRedirect` and `acquireTokenRedirect`), you must register a callback handlers  using `handleRedirectCallback(authCallback)` where `authCallback = function(AuthError, AuthResponse)`. The callback function is called after the authentication request is completed either successfully or with a failure. This is not required for the popup flows since they return promises.\n\n```JavaScript\n    var msalConfig = {\n        auth: {\n            clientId: 'your_client_id'\n        }\n    };\n\n    var msalInstance = new Msal.UserAgentApplication(msalConfig);\n\n    msalInstance.handleRedirectCallback((error, response) => {\n        // handle redirect response or error\n    });\n\n```\n\nFor details on the configuration options, read [Initializing client applications with MSAL.js](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications).\n\n#### 2. Login the user\n\nYour app must login the user with either the `loginPopup` or the `loginRedirect` method to establish user context.\n\nWhen the login methods are called and the authentication of the user is completed by the Azure AD service, an [id token](https://docs.microsoft.com/en-us/azure/active-directory/develop/id-tokens) is returned which is used to identify the user with some basic information.\n\nWhen you login a user, you can pass in scopes that the user can pre consent to on login, however this is not required. Please note that consenting to scopes on login, does not return an access_token for these scopes, but gives you the opportunity to obtain a token silently with these scopes passed in, with no further interaction from the user.\n\nIt is best practice to only request scopes you need when you need them, a concept called dynamic consent. While this can create more interactive consent for users in your application, it also reduces drop-off from users that may be uneasy granting a large list of permissions for features they are not yet using.\n\nAAD will only allow you to get consent for 3 resources at a time, although you can request many scopes within a resource.\nWhen the user makes a login request, you can pass in multiple resources and their corresponding scopes because AAD issues an idToken pre consenting those scopes. However acquireToken calls are valid only for one resource / multiple scopes. If you need to access multiple resources, please make separate acquireToken calls per resource.\n\n```JavaScript\n   var loginRequest = {\n       scopes: [\"user.read\", \"mail.send\"] // optional Array<string>\n   };\n\n    msalInstance.loginPopup(loginRequest)\n        .then(response => {\n            // handle response\n        })\n        .catch(err => {\n            // handle error\n        });\n\n```\n\n#### 3. Get an access token to call an API\n\nIn MSAL, you can get access tokens for the APIs your app needs to call using the `acquireTokenSilent` method which makes a silent request(without prompting the user with UI) to Azure AD to obtain an access token. The Azure AD service then returns an [access token](https://docs.microsoft.com/en-us/azure/active-directory/develop/access-tokens) containing the user consented scopes to allow your app to securely call the API.\n\nYou can use `acquireTokenRedirect` or `acquireTokenPopup` to initiate interactive requests, although, it is best practice to only show interactive experiences if you are unable to obtain a token silently due to interaction required errors. If you are using an interactive token call, it must match the login method used in your application. (`loginPopup`=> `acquireTokenPopup`, `loginRedirect` => `acquireTokenRedirect`).\n\nIf the `acquireTokenSilent` call fails with an error of type `InteractionRequiredAuthError` you will need to initiate an interactive request.  This could happen for many reasons including scopes that have been revoked, expired tokens, or password changes.\n\n`acquireTokenSilent` will look for a valid token in the cache, and if it is close to expiring or does not exist, will automatically try to refresh it for you.\n\nSee [Request and Response Data Types](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL.js-1.0.0-api-release#signing-in-and-getting-tokens-with-msaljs) for reference.\n\n```JavaScript\n    // if the user is already logged in you can acquire a token\n    if (msalInstance.getAccount()) {\n        var tokenRequest = {\n            scopes: [\"user.read\", \"mail.send\"]\n        };\n        msalInstance.acquireTokenSilent(tokenRequest)\n            .then(response => {\n                // get access token from response\n                // response.accessToken\n            })\n            .catch(err => {\n                // could also check if err instance of InteractionRequiredAuthError if you can import the class.\n                if (err.name === \"InteractionRequiredAuthError\") {\n                    return msalnstance.acquireTokenPopup(tokenRequest)\n                        .then(response => {\n                            // get access token from response\n                            // response.accessToken\n                        })\n                        .catch(err => {\n                            // handle error\n                        });\n                }\n            });\n    } else {\n        // user is not logged in, you will need to log them in to acquire a token\n    }\n```\n\n#### 4. Use the token as a bearer in an HTTP request to call the Microsoft Graph or a Web API\n\n```JavaScript\n    var headers = new Headers();\n    var bearer = \"Bearer \" + token;\n    headers.append(\"Authorization\", bearer);\n    var options = {\n         method: \"GET\",\n         headers: headers\n    };\n    var graphEndpoint = \"https://graph.microsoft.com/v1.0/me\";\n\n    fetch(graphEndpoint, options)\n        .then(resp => {\n             //do something with response\n        });\n```\n\nYou can learn further details about MSAL.js functionality documented in the [MSAL Wiki](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki) and find complete [code samples](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/Samples).\n\n```JavaScript\n    var headers = new Headers();\n    var bearer = \"Bearer \" + token;\n    headers.append(\"Authorization\", bearer);\n    var options = {\n         method: \"GET\",\n         headers: headers\n    };\n    var graphEndpoint = \"https://graph.microsoft.com/v1.0/me\";\n\n    fetch(graphEndpoint, options)\n        .then(resp => {\n             //do something with response\n        });\n```\n\nYou can learn further details about MSAL.js functionality documented in the [MSAL Wiki](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki) and find complete [code samples](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/Samples).\n\n## Community Help and Support\n\n- [FAQs](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/FAQs) for access to our frequently asked questions\n\n- [Stack Overflow](http://stackoverflow.com/questions/tagged/msal) using \"msal\" and \"msal.js\" tag.\n\nWe highly recommend you ask your questions on Stack Overflow first and browse existing issues to see if someone has asked your question before.\n\n- [GitHub Issues](../../issues) for reporting a bug or feature requests\n\n- [User Voice page](https://feedback.azure.com/forums/169401-azure-active-directory) to provide recommendations and/or feedback\n\n## Contribute\n\nWe enthusiastically welcome contributions and feedback. Please read the [contributing guide](contributing.md) before you begin.\n\n## Security Library\n\nThis library controls how users sign-in and access services. We recommend you always take the latest version of our library in your app when possible. We use [semantic versioning](http://semver.org) so you can control the risk associated with updating your app. As an example, always downloading the latest minor version number (e.g. x.*y*.x) ensures you get the latest security and feature enhanements but our API surface remains the same. You can always see the latest version and release notes under the Releases tab of GitHub.\n\n## Security Reporting\n\nIf you find a security issue with our libraries or services please report it to [secure@microsoft.com](mailto:secure@microsoft.com) with as much detail as possible. Your submission may be eligible for a bounty through the [Microsoft Bounty](http://aka.ms/bugbounty) program. Please do not post security issues to GitHub Issues or any other public site. We will contact you shortly upon receiving the information. We encourage you to get notifications of when security incidents occur by visiting [this page](https://technet.microsoft.com/en-us/security/dd252948) and subscribing to Security Advisory Alerts.\n\n## License\n\nCopyright (c) Microsoft Corporation.  All rights reserved. Licensed under the MIT License (the \"License\");\n\n## We Value and Adhere to the Microsoft Open Source Code of Conduct\n\nThis project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/). For more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or contact [opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional questions or comments.\n",
    "licenseText": "MIT License\n\nCopyright (c) Microsoft Corporation. All rights reserved.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE\n"
  },
  "artifacts": [],
  "remote": {
    "resolved": "https://registry.yarnpkg.com/msal/-/msal-1.1.3.tgz#d8c501d513f5e52eaf000f20a245526fc1ecaa2a",
    "type": "tarball",
    "reference": "https://registry.yarnpkg.com/msal/-/msal-1.1.3.tgz",
    "hash": "d8c501d513f5e52eaf000f20a245526fc1ecaa2a",
    "integrity": "sha512-cdShb+N1H3OyR1y46ij6OO7QzeqC6BxrbrNcouS4JBrr1+DnZ55TumxQKEzWmTXHvsbsuz5PCyXZl812Un8L9g==",
    "registry": "npm",
    "packageName": "msal",
    "cacheIntegrity": "sha512-cdShb+N1H3OyR1y46ij6OO7QzeqC6BxrbrNcouS4JBrr1+DnZ55TumxQKEzWmTXHvsbsuz5PCyXZl812Un8L9g== sha1-2MUB1RP15S6vAA8gokVSb8Hsqio="
  },
  "registry": "npm",
  "hash": "d8c501d513f5e52eaf000f20a245526fc1ecaa2a"
}